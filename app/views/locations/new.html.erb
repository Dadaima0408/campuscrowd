<% content_for :title, "New location" %>

<h1>New location</h1>

<br>
<div>
  <%= link_to "Back to locations", locations_path %>
</div>

<h1>å ´æ‰€ç™»éŒ²</h1>

<div style="position: relative; margin-bottom: 1rem;">
  <%= image_tag "ChuTamamap.png", id: "campus-map", style: "width: 100%; border: 1px solid #ccc;" %>
</div>

<p>ğŸ“ ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åº§æ¨™ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚</p>

<%= form_with(model: @location, local: true) do |form| %>
  <div class="field">
    <%= form.label :name %>
    <%= form.text_field :name %>
  </div>

  <div class="field">
    <%= form.label :category %>
    <%= form.text_field :category %>
  </div>

<div class="mb-2">
  <%= form.label :icon, "ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç›´æ¥å…¥åŠ›ï¼‰", class: "form-label" %>
  <%= form.text_field :icon, class: "form-control", placeholder: "ä¾‹ï¼šğŸ“, ğŸ«, ğŸ½ï¸, ğŸ“š, ğŸšª" %>
</div>

  <div class="field">
    <%= form.label :x, "X åº§æ¨™" %>
    <%= form.number_field :x, id: "input-x" %>
  </div>

  <div class="field">
    <%= form.label :y, "Y åº§æ¨™" %>
    <%= form.number_field :y, id: "input-y" %>
  </div>

  <div class="actions">
    <%= form.submit "ç™»éŒ²", class: "btn btn-success" %>
  </div>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const map = document.getElementById("campus-map");
    const inputX = document.getElementById("input-x");
    const inputY = document.getElementById("input-y");

    map.addEventListener("click", function(event) {
      const rect = map.getBoundingClientRect();
      const scaleX = map.naturalWidth / map.width;
      const scaleY = map.naturalHeight / map.height;

      const x = Math.round((event.clientX - rect.left) * scaleX);
      const y = Math.round((event.clientY - rect.top) * scaleY);

      inputX.value = x;
      inputY.value = y;
    });
  });
</script>